{"file":"/app/tests/agents.test.ts","mappings":";AAAA,2FAA2F;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE3F,uCAAyB;AACzB,2CAA6B;AAE7B,uDAAuD;AACvD,oDAAyD;AACzD,gDAAyD;AAGzD,6CAA6C;AAC7C,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;AAE/C,QAAQ,CAAC,4CAA4C,EAAE,GAAG,EAAE;IACxD,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC;QACzB,OAAO,EAAE,WAAW;QACpB,QAAQ,EAAE,mBAAmB;QAC7B,WAAW,EAAE,uHAAuH;QACpI,KAAK,EAAE,CAAC,kBAAkB,EAAE,oBAAoB,CAAC;QACjD,WAAW,EAAE,CAAC,gBAAgB,CAAC;QAC/B,QAAQ,EAAE,UAAU;KACvB,CAAC,CAAC;IACH,IAAI,eAAuB,CAAC;IAE5B,yBAAyB;IACzB,SAAS,CAAC,GAAG,EAAE;QACX,eAAe,GAAG,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,mBAAmB,CAAC,EAAE,OAAO,CAAC,CAAC;IAC3H,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,uDAAuD,EAAE,KAAK,IAAI,EAAE;QACrE,MAAM,MAAM,GAAG,MAAM,IAAA,qBAAa,EAAC,KAAK,CAAC,CAAC;QAE1C,MAAM,CAAC,MAAM,CAAC,CAAC,WAAW,EAAE,CAAC;QAC7B,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,CAAC;QACrC,qGAAqG;QACrG,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAC7D,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,CAAC;QAClC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,kFAAkF,EAAE,KAAK,IAAI,EAAE;QAChG,gEAAgE;QAChE,MAAM,WAAW,GAAoB;YACjC,cAAc,EAAE,sBAAsB;YACtC,gBAAgB,EAAE,sBAAsB;YACxC,WAAW,EAAE,EAAE;YACf,SAAS,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,cAAc,EAAE,EAAE,EAAE,UAAU,EAAE,EAAE,EAAE;YAC5E,KAAK,EAAE,EAAE;YACT,aAAa,EAAE,EAAE;YACjB,eAAe,EAAE,EAAE;SACtB,CAAC;QAEF,MAAM,SAAS,GAAG,MAAM,IAAA,yBAAiB,EAAC,WAAW,EAAE,KAAK,CAAC,CAAC;QAE9D,MAAM,CAAC,SAAS,CAAC,CAAC,WAAW,EAAE,CAAC;QAChC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;QACpC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;QAEpC,kCAAkC;QAClC,MAAM,eAAe,GAAG,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,eAAe,CAAC,EAAE,OAAO,CAAC,CAAC;QAErH,yBAAyB;QACzB,oEAAoE;QACpE,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC,CAAC;QAE7D,oDAAoD;QACpD,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,4DAA4D,CAAC,CAAC;QAC9F,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;IACrD,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC","names":[],"sources":["/app/tests/agents.test.ts"],"sourcesContent":["// C:\\Users\\drpt0\\iCloudDrive\\Developer\\Projects\\Active\\opencode.tools\\tests\\agents.test.ts\n\nimport * as fs from 'fs';\nimport * as path from 'path';\n\n// Use clean ES imports, relying on ts-jest for interop\nimport { gatherDossier } from '../agents/research/index';\nimport { generateDocuments } from '../agents/docs/index';\nimport { ResearchDossier } from '../agents/research/types';\n\n// Define the root of the project for pathing\nconst projectRoot = path.join(__dirname, '..');\n\ndescribe('Phase 2 Agents: Research and Documentation', () => {\n    const brief = JSON.stringify({\n        company: 'Acme Corp',\n        industry: 'Construction Tech',\n        description: 'Implement a real-time material tracking system for Acme Corp, focusing on AI waste prediction and mobile performance.',\n        goals: ['Waste prediction', 'Mobile performance'],\n        constraints: ['Legacy systems'],\n        timeline: '3 months'\n    });\n    let dossierMarkdown: string;\n\n    // Load golden files once\n    beforeAll(() => {\n        dossierMarkdown = fs.readFileSync(path.join(projectRoot, 'tests', 'golden', 'research', 'dossier-output.md'), 'utf-8');\n    });\n\n    test('Research Agent: gatherDossier returns structured data', async () => {\n        const result = await gatherDossier(brief);\n\n        expect(result).toBeDefined();\n        expect(result.dossier).toBeDefined();\n        // Since we are using a real agent with mock webfetch, the content will be based on the mock response\n        expect(result.dossier.companySummary).toContain('Acme Corp'); \n        expect(result.meta).toBeDefined();\n        expect(result.sources).toBeDefined();\n    });\n\n    test('Documentation Agent: generateDocuments produces PRD and SOW matching golden file', async () => {\n        // Mock the dossier output (using the ResearchDossier structure)\n        const mockDossier: ResearchDossier = {\n            companySummary: 'Acme Corp summary...',\n            industryOverview: 'Industry overview...',\n            competitors: [],\n            techStack: { frontend: [], backend: [], infrastructure: [], thirdParty: [] },\n            risks: [],\n            opportunities: [],\n            recommendations: []\n        };\n\n        const documents = await generateDocuments(mockDossier, brief);\n\n        expect(documents).toBeDefined();\n        expect(documents.prd).toBeDefined();\n        expect(documents.sow).toBeDefined();\n\n        // Load expected PRD golden output\n        const prdGoldenOutput = fs.readFileSync(path.join(projectRoot, 'tests', 'golden', 'docs', 'prd-output.md'), 'utf-8');\n\n        // Golden file comparison\n        // The Docs Agent is mocked to read the golden file directly for PRD\n        expect(documents.prd.trim()).toEqual(prdGoldenOutput.trim());\n        \n        // Simple verification for the simulated SOW content\n        expect(documents.sow).toContain('Statement of Work (SOW) - Real-Time Material Tracking v1.0');\n        expect(documents.sow).toContain('End of Week 5');\n    });\n});\n"],"version":3}