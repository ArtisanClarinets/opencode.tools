{"file":"/app/tests/agents/research-agent.test.ts","mappings":"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","names":[],"sources":["/app/tests/agents/research-agent.test.ts"],"sourcesContent":["import { ResearchAgent } from '../../agents/research/research-agent';\nimport { ResearchInput } from '../../agents/research/types';\n\ndescribe('ResearchAgent', () => {\n  let agent: ResearchAgent;\n\n  beforeEach(() => {\n    agent = new ResearchAgent();\n  });\n\n  describe('execute', () => {\n    it('should return a complete research dossier', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company specializing in payments',\n          goals: ['Increase market share', 'Improve user experience'],\n          constraints: ['Regulatory compliance', 'Security requirements'],\n          timeline: '6 months'\n        },\n        keywords: ['fintech', 'payments', 'startup'],\n        urls: ['https://techcorp.com'],\n        priorNotes: 'Previous research indicates strong growth potential'\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result).toBeDefined();\n      expect(result.dossier).toBeDefined();\n      expect(result.sources).toBeDefined();\n      expect(result.meta).toBeDefined();\n    });\n\n    it('should include company summary in dossier', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company specializing in payments',\n          goals: ['Increase market share'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.dossier.companySummary).toBeDefined();\n      expect(result.dossier.companySummary.length).toBeGreaterThan(0);\n    });\n\n    it('should include industry overview in dossier', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company',\n          goals: ['Growth'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.dossier.industryOverview).toBeDefined();\n      expect(result.dossier.industryOverview.length).toBeGreaterThan(0);\n    });\n\n    it('should include competitor analysis in dossier', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company',\n          goals: ['Growth'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.dossier.competitors).toBeDefined();\n      expect(Array.isArray(result.dossier.competitors)).toBe(true);\n      expect(result.dossier.competitors.length).toBeGreaterThan(0);\n    });\n\n    it('should include tech stack assessment in dossier', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company',\n          goals: ['Growth'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.dossier.techStack).toBeDefined();\n      expect(result.dossier.techStack.frontend).toBeDefined();\n      expect(result.dossier.techStack.backend).toBeDefined();\n      expect(result.dossier.techStack.infrastructure).toBeDefined();\n      expect(result.dossier.techStack.thirdParty).toBeDefined();\n    });\n\n    it('should include risks in dossier', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company',\n          goals: ['Growth'],\n          constraints: ['Regulatory compliance'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.dossier.risks).toBeDefined();\n      expect(Array.isArray(result.dossier.risks)).toBe(true);\n      expect(result.dossier.risks.length).toBeGreaterThan(0);\n    });\n\n    it('should include opportunities in dossier', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company',\n          goals: ['Growth', 'Market expansion'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.dossier.opportunities).toBeDefined();\n      expect(Array.isArray(result.dossier.opportunities)).toBe(true);\n      expect(result.dossier.opportunities.length).toBeGreaterThan(0);\n    });\n\n    it('should include recommendations in dossier', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company',\n          goals: ['Growth'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.dossier.recommendations).toBeDefined();\n      expect(Array.isArray(result.dossier.recommendations)).toBe(true);\n      expect(result.dossier.recommendations.length).toBeGreaterThan(0);\n    });\n\n    it('should include sources with required fields', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company',\n          goals: ['Growth'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.sources).toBeDefined();\n      expect(Array.isArray(result.sources)).toBe(true);\n      \n      if (result.sources.length > 0) {\n        const source = result.sources[0];\n        expect(source).toHaveProperty('url');\n        expect(source).toHaveProperty('title');\n        expect(source).toHaveProperty('relevance');\n        expect(source).toHaveProperty('accessedAt');\n      }\n    });\n\n    it('should include complete metadata', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: 'TechCorp',\n          industry: 'FinTech',\n          description: 'A fintech company',\n          goals: ['Growth'],\n          timeline: '6 months'\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result.meta).toBeDefined();\n      expect(result.meta).toHaveProperty('agent');\n      expect(result.meta).toHaveProperty('promptVersion');\n      expect(result.meta).toHaveProperty('mcpVersion');\n      expect(result.meta).toHaveProperty('timestamp');\n      expect(result.meta).toHaveProperty('runId');\n    });\n\n    it('should handle empty input gracefully', async () => {\n      const input: ResearchInput = {\n        brief: {\n          company: '',\n          industry: '',\n          description: '',\n          goals: [],\n          timeline: ''\n        }\n      };\n\n      const result = await agent.execute(input);\n\n      expect(result).toBeDefined();\n      expect(result.dossier).toBeDefined();\n      expect(result.meta).toBeDefined();\n    });\n  });\n});"],"version":3}