e3b8b10a43e56c13f801ef4b7f4aec7d
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const gatekeeper_1 = require("../../../src/governance/gatekeeper");
describe('ResearchGatekeeper', () => {
    let gatekeeper;
    beforeEach(() => {
        gatekeeper = new gatekeeper_1.ResearchGatekeeper(3, 2);
    });
    it('should pass when sources and domains are sufficient', () => {
        const sources = [
            { url: 'https://example.com/1', title: '1', relevance: 'High', accessedAt: 'now' },
            { url: 'https://example.com/2', title: '2', relevance: 'High', accessedAt: 'now' },
            { url: 'https://other.com/1', title: '3', relevance: 'High', accessedAt: 'now' }
        ];
        const result = gatekeeper.evaluate(sources);
        expect(result.passed).toBe(true);
        expect(result.score).toBe(1.0);
    });
    it('should fail when sources are insufficient', () => {
        const sources = [
            { url: 'https://example.com/1', title: '1', relevance: 'High', accessedAt: 'now' }
        ];
        const result = gatekeeper.evaluate(sources);
        expect(result.passed).toBe(false);
        expect(result.reasons.some(r => r.includes('Insufficient sources'))).toBe(true);
    });
    it('should fail when domain diversity is insufficient', () => {
        const sources = [
            { url: 'https://example.com/1', title: '1', relevance: 'High', accessedAt: 'now' },
            { url: 'https://example.com/2', title: '2', relevance: 'High', accessedAt: 'now' },
            { url: 'https://example.com/3', title: '3', relevance: 'High', accessedAt: 'now' }
        ];
        const result = gatekeeper.evaluate(sources);
        expect(result.passed).toBe(false);
        expect(result.reasons.some(r => r.includes('Insufficient domain diversity'))).toBe(true);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2FwcC90ZXN0cy91bml0L2dvdmVybmFuY2UvZ2F0ZWtlZXBlci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsbUVBQXdFO0FBRXhFLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7SUFDbEMsSUFBSSxVQUE4QixDQUFDO0lBRW5DLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxVQUFVLEdBQUcsSUFBSSwrQkFBa0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDNUMsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMscURBQXFELEVBQUUsR0FBRyxFQUFFO1FBQzdELE1BQU0sT0FBTyxHQUFHO1lBQ2QsRUFBRSxHQUFHLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUU7WUFDbEYsRUFBRSxHQUFHLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUU7WUFDbEYsRUFBRSxHQUFHLEVBQUUscUJBQXFCLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUU7U0FDakYsQ0FBQztRQUVGLE1BQU0sTUFBTSxHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDNUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDakMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakMsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1FBQ25ELE1BQU0sT0FBTyxHQUFHO1lBQ2QsRUFBRSxHQUFHLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUU7U0FDbkYsQ0FBQztRQUVGLE1BQU0sTUFBTSxHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDNUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEYsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1FBQzNELE1BQU0sT0FBTyxHQUFHO1lBQ2QsRUFBRSxHQUFHLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUU7WUFDbEYsRUFBRSxHQUFHLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUU7WUFDbEYsRUFBRSxHQUFHLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUU7U0FDbkYsQ0FBQztRQUVGLE1BQU0sTUFBTSxHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDNUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDM0YsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvYXBwL3Rlc3RzL3VuaXQvZ292ZXJuYW5jZS9nYXRla2VlcGVyLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVzZWFyY2hHYXRla2VlcGVyIH0gZnJvbSAnLi4vLi4vLi4vc3JjL2dvdmVybmFuY2UvZ2F0ZWtlZXBlcic7XG5cbmRlc2NyaWJlKCdSZXNlYXJjaEdhdGVrZWVwZXInLCAoKSA9PiB7XG4gIGxldCBnYXRla2VlcGVyOiBSZXNlYXJjaEdhdGVrZWVwZXI7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgZ2F0ZWtlZXBlciA9IG5ldyBSZXNlYXJjaEdhdGVrZWVwZXIoMywgMik7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcGFzcyB3aGVuIHNvdXJjZXMgYW5kIGRvbWFpbnMgYXJlIHN1ZmZpY2llbnQnLCAoKSA9PiB7XG4gICAgY29uc3Qgc291cmNlcyA9IFtcbiAgICAgIHsgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS8xJywgdGl0bGU6ICcxJywgcmVsZXZhbmNlOiAnSGlnaCcsIGFjY2Vzc2VkQXQ6ICdub3cnIH0sXG4gICAgICB7IHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vMicsIHRpdGxlOiAnMicsIHJlbGV2YW5jZTogJ0hpZ2gnLCBhY2Nlc3NlZEF0OiAnbm93JyB9LFxuICAgICAgeyB1cmw6ICdodHRwczovL290aGVyLmNvbS8xJywgdGl0bGU6ICczJywgcmVsZXZhbmNlOiAnSGlnaCcsIGFjY2Vzc2VkQXQ6ICdub3cnIH1cbiAgICBdO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gZ2F0ZWtlZXBlci5ldmFsdWF0ZShzb3VyY2VzKTtcbiAgICBleHBlY3QocmVzdWx0LnBhc3NlZCkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QocmVzdWx0LnNjb3JlKS50b0JlKDEuMCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZmFpbCB3aGVuIHNvdXJjZXMgYXJlIGluc3VmZmljaWVudCcsICgpID0+IHtcbiAgICBjb25zdCBzb3VyY2VzID0gW1xuICAgICAgeyB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tLzEnLCB0aXRsZTogJzEnLCByZWxldmFuY2U6ICdIaWdoJywgYWNjZXNzZWRBdDogJ25vdycgfVxuICAgIF07XG5cbiAgICBjb25zdCByZXN1bHQgPSBnYXRla2VlcGVyLmV2YWx1YXRlKHNvdXJjZXMpO1xuICAgIGV4cGVjdChyZXN1bHQucGFzc2VkKS50b0JlKGZhbHNlKTtcbiAgICBleHBlY3QocmVzdWx0LnJlYXNvbnMuc29tZShyID0+IHIuaW5jbHVkZXMoJ0luc3VmZmljaWVudCBzb3VyY2VzJykpKS50b0JlKHRydWUpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGZhaWwgd2hlbiBkb21haW4gZGl2ZXJzaXR5IGlzIGluc3VmZmljaWVudCcsICgpID0+IHtcbiAgICBjb25zdCBzb3VyY2VzID0gW1xuICAgICAgeyB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tLzEnLCB0aXRsZTogJzEnLCByZWxldmFuY2U6ICdIaWdoJywgYWNjZXNzZWRBdDogJ25vdycgfSxcbiAgICAgIHsgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS8yJywgdGl0bGU6ICcyJywgcmVsZXZhbmNlOiAnSGlnaCcsIGFjY2Vzc2VkQXQ6ICdub3cnIH0sXG4gICAgICB7IHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vMycsIHRpdGxlOiAnMycsIHJlbGV2YW5jZTogJ0hpZ2gnLCBhY2Nlc3NlZEF0OiAnbm93JyB9XG4gICAgXTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGdhdGVrZWVwZXIuZXZhbHVhdGUoc291cmNlcyk7XG4gICAgZXhwZWN0KHJlc3VsdC5wYXNzZWQpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChyZXN1bHQucmVhc29ucy5zb21lKHIgPT4gci5pbmNsdWRlcygnSW5zdWZmaWNpZW50IGRvbWFpbiBkaXZlcnNpdHknKSkpLnRvQmUodHJ1ZSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=